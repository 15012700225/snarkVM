// Copyright (C) 2019-2021 Aleo Systems Inc.
// This file is part of the snarkVM library.

// The snarkVM library is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// The snarkVM library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with the snarkVM library. If not, see <https://www.gnu.org/licenses/>.

use snarkvm_fields::{FftParameters, FieldParameters, Fp832, Fp832Parameters, PoseidonMDSParameters};
use snarkvm_utilities::biginteger::BigInteger832 as BigInteger;

pub type Fq = Fp832<FqParameters>;

pub struct FqParameters;

impl Fp832Parameters for FqParameters {}

impl FftParameters for FqParameters {
    type BigInteger = BigInteger;

    const TWO_ADICITY: u32 = 3;
    #[rustfmt::skip]
    const TWO_ADIC_ROOT_OF_UNITY: BigInteger = BigInteger([
        18044746167194862600u64,
        63590321303744709u64,
        5009346151370959890u64,
        2859114157767503991u64,
        8301813204852325413u64,
        5629414263664332594u64,
        2637340888701394641u64,
        17433538052687852753u64,
        2230763098934759248u64,
        3785382115983092023u64,
        8895511354022222370u64,
        15792083141709071785u64,
        1328u64,
    ]);
}

impl FieldParameters for FqParameters {
    const CAPACITY: u32 = Self::MODULUS_BITS - 1;
    /// GENERATOR = 13
    const GENERATOR: BigInteger = BigInteger([
        16669393626057438558u64,
        1640520694378723217u64,
        1598646156981121135u64,
        12401834967100173388u64,
        2356467520877704673u64,
        14759118825104212161u64,
        5556628239575210651u64,
        5317520392768798654u64,
        16398429955031064995u64,
        3556102264904210145u64,
        8166834915717907988u64,
        11926665585800594452u64,
        11716u64,
    ]);
    const INV: u64 = 14469047335842394791u64;
    /// MODULUS = 22369874298875696930346742206501054934775599465297184582183496627646774052458024540232479018147881220178054575403841904557897715222633333372134756426301062487682326574958588001132586331462553235407484089304633076250782629492557320825577
    const MODULUS: BigInteger = BigInteger([
        0xdace79b57b942ae9,
        0x545d85c16dfd424a,
        0xee135c065f4d26b7,
        0x9c2f764a12c4024b,
        0x1ad533049cfe6a39,
        0x52a3fb77c79c1320,
        0xab3596c8617c5792,
        0x830c728d80f9d78b,
        0x6a7223ee72023d07,
        0xbc5d176b746af026,
        0xe959283d8f526663,
        0xc4d2263babf8941f,
        0x3848,
    ]);
    const MODULUS_BITS: u32 = 782;
    const MODULUS_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0x6d673cdabdca1574,
        0xaa2ec2e0b6fea125,
        0xf709ae032fa6935b,
        0xce17bb2509620125,
        0xd6a99824e7f351c,
        0x2951fdbbe3ce0990,
        0xd59acb6430be2bc9,
        0xc1863946c07cebc5,
        0x353911f739011e83,
        0xde2e8bb5ba357813,
        0xf4ac941ec7a93331,
        0x6269131dd5fc4a0f,
        0x1c24,
    ]);
    const R: BigInteger = BigInteger([
        11190988450819017841u64,
        16170411717126802030u64,
        2265463223430229059u64,
        16946880912571045974u64,
        11155248462028513229u64,
        12855672356664541314u64,
        8489376931127408159u64,
        2655797810825538098u64,
        9648483887143916718u64,
        17514963461276738952u64,
        16777089214204267338u64,
        15649035958020076168u64,
        8659u64,
    ]);
    const R2: BigInteger = BigInteger([
        13983406830510863714u64,
        17863856572171232656u64,
        1698388424046564526u64,
        1773634430448388392u64,
        8684647957094413275u64,
        3992637317298078843u64,
        18420879196616862245u64,
        3238482510270583127u64,
        7928200707794018216u64,
        10024831010452223910u64,
        9613847725664942650u64,
        15361265984156787358u64,
        7833u64,
    ]);
    const REPR_SHAVE_BITS: u32 = 50;
    // T =
    // 2796234287359462116293342775812631866846949933162148072772937078455846756557253067529059877268485152522256821925480238069737214402829166671516844553287632810960290821869823500141573291432819154425935511163079134531347828686569665103197
    const T: BigInteger = BigInteger([
        0x5b59cf36af72855d,
        0xea8bb0b82dbfa849,
        0x7dc26b80cbe9a4d6,
        0x3385eec942588049,
        0x35aa660939fcd47,
        0x4a547f6ef8f38264,
        0x7566b2d90c2f8af2,
        0xf0618e51b01f3af1,
        0xcd4e447dce4047a0,
        0x778ba2ed6e8d5e04,
        0xfd2b2507b1ea4ccc,
        0x189a44c7757f1283,
        0x709,
    ]);
    // (T - 1)/2 =
    // 1398117143679731058146671387906315933423474966581074036386468539227923378278626533764529938634242576261128410962740119034868607201414583335758422276643816405480145410934911750070786645716409577212967755581539567265673914343284832551598
    const T_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0xadace79b57b942ae,
        0x7545d85c16dfd424,
        0xbee135c065f4d26b,
        0x99c2f764a12c4024,
        0x1ad533049cfe6a3,
        0x252a3fb77c79c132,
        0xbab3596c8617c579,
        0x7830c728d80f9d78,
        0x66a7223ee72023d0,
        0x3bc5d176b746af02,
        0xfe959283d8f52666,
        0x8c4d2263babf8941,
        0x384,
    ]);
}

impl PoseidonMDSParameters for FqParameters {
    const POSEIDON_ALPHA: u64 = 37;
    const POSEIDON_FULL_ROUNDS: u32 = 8;
    const POSEIDON_MDS: [[Self::BigInteger; 3]; 3] = [
        [
            BigInteger([
                1144811251090491003u64,
                6725640796212228209u64,
                7308914900384379513u64,
                12770647596149764793u64,
                17638192784909101333u64,
                4626683101821302935u64,
                14462286997838912977u64,
                13307480931885482739u64,
                5300454711832372159u64,
                17397425672581175228u64,
                16153052011219023556u64,
                2429959761582612521u64,
                4054u64,
            ]),
            BigInteger([
                15960019957214032714u64,
                13202821502942312716u64,
                160359431350892542u64,
                6159122393027163212u64,
                2681204329876836185u64,
                8590363788917072227u64,
                7245019507083266676u64,
                1119305714949311225u64,
                3236348646542773932u64,
                7475638161353188697u64,
                16362130504605903013u64,
                1898413749285475273u64,
                8856u64,
            ]),
            BigInteger([
                12634909838142400001u64,
                12724067401420669866u64,
                3272184040522621199u64,
                10826585474041551364u64,
                15022604729706636796u64,
                6089665088328952892u64,
                16644007459569199111u64,
                2159467240073821902u64,
                1868673455223155107u64,
                11421590882417370985u64,
                5892502201931219186u64,
                13823672038829129980u64,
                10374u64,
            ]),
        ],
        [
            BigInteger([
                2715182433274887327u64,
                547053779349574206u64,
                8435374929815236077u64,
                4362065381308624746u64,
                604533077813884569u64,
                10948736979875308087u64,
                1268808771002530386u64,
                3862412780185720905u64,
                4229253872217019601u64,
                13923595706102682584u64,
                4541895106441672022u64,
                7906917771207219058u64,
                13177u64,
            ]),
            BigInteger([
                4969499062095410460u64,
                9083573639309879654u64,
                8849511254178891611u64,
                16355759321411500708u64,
                15430824488155637733u64,
                2234407647876931700u64,
                15776259719412016131u64,
                10388473547713771799u64,
                5170010616458723905u64,
                14191859332216431277u64,
                1780622238104710337u64,
                13434876095187697462u64,
                24u64,
            ]),
            BigInteger([
                17638148836265865319u64,
                871956697432231243u64,
                11902535217332163013u64,
                8908718639002137301u64,
                1381796942716570499u64,
                6541041171781292551u64,
                3805801342784875146u64,
                17552600255899696489u64,
                3928851739271785577u64,
                13053849308707309851u64,
                12995956653959202195u64,
                5538005590713973683u64,
                3690u64,
            ]),
        ],
        [
            BigInteger([
                4536373754002153610u64,
                3742909021163038331u64,
                13167697335192830047u64,
                11355981133324918075u64,
                6414582307258140425u64,
                4481681986143919610u64,
                15441422837318917566u64,
                2770697149348002547u64,
                8380478867393504446u64,
                5861188266087240629u64,
                10675121533459935781u64,
                9978312097307040019u64,
                3032u64,
            ]),
            BigInteger([
                16838671073758164108u64,
                15090049424120062047u64,
                11334458214997513406u64,
                17116505482660418903u64,
                6595719776503439840u64,
                16559880757788122517u64,
                14669010970789398534u64,
                5054402400198529704u64,
                15602967072885390636u64,
                12957432438559146376u64,
                8217771587350638069u64,
                6197423396970061491u64,
                10379u64,
            ]),
            BigInteger([
                12123567020685440146u64,
                7413409539257417407u64,
                3725749817601357862u64,
                2141694283891123483u64,
                10830783222869120128u64,
                1526416999733110340u64,
                7386011482999870517u64,
                2402871401102102998u64,
                15903662538226487268u64,
                2967427371595679600u64,
                6852474325392405013u64,
                3640990548744933116u64,
                8121u64,
            ]),
        ],
    ];
    const POSEIDON_PARTIAL_ROUNDS: u32 = 23;
}
