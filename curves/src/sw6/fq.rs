// Copyright (C) 2019-2021 Aleo Systems Inc.
// This file is part of the snarkVM library.

// The snarkVM library is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// The snarkVM library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with the snarkVM library. If not, see <https://www.gnu.org/licenses/>.

use snarkvm_fields::{FftParameters, FieldParameters, Fp832, Fp832Parameters, PoseidonMDSParameters};
use snarkvm_utilities::biginteger::BigInteger832 as BigInteger;

pub type Fq = Fp832<FqParameters>;

pub struct FqParameters;

impl Fp832Parameters for FqParameters {}

impl FftParameters for FqParameters {
    type BigInteger = BigInteger;

    const TWO_ADICITY: u32 = 3;
    #[rustfmt::skip]
    const TWO_ADIC_ROOT_OF_UNITY: BigInteger = BigInteger([
        18044746167194862600u64,
        63590321303744709u64,
        5009346151370959890u64,
        2859114157767503991u64,
        8301813204852325413u64,
        5629414263664332594u64,
        2637340888701394641u64,
        17433538052687852753u64,
        2230763098934759248u64,
        3785382115983092023u64,
        8895511354022222370u64,
        15792083141709071785u64,
        1328u64,
    ]);
}

impl FieldParameters for FqParameters {
    const CAPACITY: u32 = Self::MODULUS_BITS - 1;
    /// GENERATOR = 13
    const GENERATOR: BigInteger = BigInteger([
        16669393626057438558u64,
        1640520694378723217u64,
        1598646156981121135u64,
        12401834967100173388u64,
        2356467520877704673u64,
        14759118825104212161u64,
        5556628239575210651u64,
        5317520392768798654u64,
        16398429955031064995u64,
        3556102264904210145u64,
        8166834915717907988u64,
        11926665585800594452u64,
        11716u64,
    ]);
    const INV: u64 = 14469047335842394791u64;
    /// MODULUS = 22369874298875696930346742206501054934775599465297184582183496627646774052458024540232479018147881220178054575403841904557897715222633333372134756426301062487682326574958588001132586331462553235407484089304633076250782629492557320825577
    const MODULUS: BigInteger = BigInteger([
        0xdace79b57b942ae9,
        0x545d85c16dfd424a,
        0xee135c065f4d26b7,
        0x9c2f764a12c4024b,
        0x1ad533049cfe6a39,
        0x52a3fb77c79c1320,
        0xab3596c8617c5792,
        0x830c728d80f9d78b,
        0x6a7223ee72023d07,
        0xbc5d176b746af026,
        0xe959283d8f526663,
        0xc4d2263babf8941f,
        0x3848,
    ]);
    const MODULUS_BITS: u32 = 782;
    const MODULUS_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0x6d673cdabdca1574,
        0xaa2ec2e0b6fea125,
        0xf709ae032fa6935b,
        0xce17bb2509620125,
        0xd6a99824e7f351c,
        0x2951fdbbe3ce0990,
        0xd59acb6430be2bc9,
        0xc1863946c07cebc5,
        0x353911f739011e83,
        0xde2e8bb5ba357813,
        0xf4ac941ec7a93331,
        0x6269131dd5fc4a0f,
        0x1c24,
    ]);
    const R: BigInteger = BigInteger([
        11190988450819017841u64,
        16170411717126802030u64,
        2265463223430229059u64,
        16946880912571045974u64,
        11155248462028513229u64,
        12855672356664541314u64,
        8489376931127408159u64,
        2655797810825538098u64,
        9648483887143916718u64,
        17514963461276738952u64,
        16777089214204267338u64,
        15649035958020076168u64,
        8659u64,
    ]);
    const R2: BigInteger = BigInteger([
        13983406830510863714u64,
        17863856572171232656u64,
        1698388424046564526u64,
        1773634430448388392u64,
        8684647957094413275u64,
        3992637317298078843u64,
        18420879196616862245u64,
        3238482510270583127u64,
        7928200707794018216u64,
        10024831010452223910u64,
        9613847725664942650u64,
        15361265984156787358u64,
        7833u64,
    ]);
    const REPR_SHAVE_BITS: u32 = 50;
    // T =
    // 2796234287359462116293342775812631866846949933162148072772937078455846756557253067529059877268485152522256821925480238069737214402829166671516844553287632810960290821869823500141573291432819154425935511163079134531347828686569665103197
    const T: BigInteger = BigInteger([
        0x5b59cf36af72855d,
        0xea8bb0b82dbfa849,
        0x7dc26b80cbe9a4d6,
        0x3385eec942588049,
        0x35aa660939fcd47,
        0x4a547f6ef8f38264,
        0x7566b2d90c2f8af2,
        0xf0618e51b01f3af1,
        0xcd4e447dce4047a0,
        0x778ba2ed6e8d5e04,
        0xfd2b2507b1ea4ccc,
        0x189a44c7757f1283,
        0x709,
    ]);
    // (T - 1)/2 =
    // 1398117143679731058146671387906315933423474966581074036386468539227923378278626533764529938634242576261128410962740119034868607201414583335758422276643816405480145410934911750070786645716409577212967755581539567265673914343284832551598
    const T_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0xadace79b57b942ae,
        0x7545d85c16dfd424,
        0xbee135c065f4d26b,
        0x99c2f764a12c4024,
        0x1ad533049cfe6a3,
        0x252a3fb77c79c132,
        0xbab3596c8617c579,
        0x7830c728d80f9d78,
        0x66a7223ee72023d0,
        0x3bc5d176b746af02,
        0xfe959283d8f52666,
        0x8c4d2263babf8941,
        0x384,
    ]);
}

impl PoseidonMDSParameters for FqParameters {
    const POSEIDON_ALPHA: u64 = 17;
    const POSEIDON_FULL_ROUNDS: u32 = 8;
    const POSEIDON_MDS: [[Self::BigInteger; 3]; 3] = [
        [
            BigInteger([
                1362074317049479739u64,
                1965502337767110238u64,
                11959752436598477233u64,
                16586388494613726875u64,
                4511478583872486576u64,
                17501403951398169709u64,
                11548499680599363586u64,
                13510898249173485824u64,
                9179860310691618530u64,
                11978410189268613292u64,
                4852958827464026031u64,
                8178408371637730964u64,
                10412u64,
            ]),
            BigInteger([
                1261397184626559636u64,
                3036137848687048573u64,
                15307329768801821652u64,
                13473320129755740105u64,
                6370342389866205825u64,
                15565791640017756013u64,
                8089640242259598120u64,
                5088409813688699477u64,
                6191886323780705985u64,
                16181426317787048874u64,
                15946010880021400703u64,
                9650054659624781367u64,
                3151u64,
            ]),
            BigInteger([
                289439248627863105u64,
                10381699995146001199u64,
                18062981712329976651u64,
                5200319922312198482u64,
                2313587162063650308u64,
                16445647665676139219u64,
                7803000131807190060u64,
                17823415587174444216u64,
                2162312818898338713u64,
                5832086886557244432u64,
                5092230044679364861u64,
                4940252673011785811u64,
                8950u64,
            ]),
        ],
        [
            BigInteger([
                5665072345852709884u64,
                13762489323194444317u64,
                4648212851491852451u64,
                14082979564842700867u64,
                15647177026630699713u64,
                10993604408613122174u64,
                5840698990092212130u64,
                16055792927429361061u64,
                3756602090112996043u64,
                10099714713863010352u64,
                13452951485114822237u64,
                7437036433657949187u64,
                9830u64,
            ]),
            BigInteger([
                4669203850802431350u64,
                4811635726005137508u64,
                15721283099940523696u64,
                9109079160365546143u64,
                2701479962559610449u64,
                13084981911088724719u64,
                5713250203509836964u64,
                6972222101679774805u64,
                144081169135447122u64,
                6257574473035115725u64,
                1892203301173694318u64,
                13331409934543135757u64,
                13537u64,
            ]),
            BigInteger([
                15235622521647367173u64,
                2431344357242136884u64,
                229053570246940681u64,
                3556545377103377644u64,
                1860718079011704237u64,
                604992871141312529u64,
                15002777759628502207u64,
                13301389884955469095u64,
                1777675708462780723u64,
                11587074192517753112u64,
                5971675204174568843u64,
                7463001792915034636u64,
                11817u64,
            ]),
        ],
        [
            BigInteger([
                17831801926111624178u64,
                14974415900232612620u64,
                18134334428196416277u64,
                3554556556774073297u64,
                4868238045566742519u64,
                11563450978512891166u64,
                9613668847074510818u64,
                2417624308251204550u64,
                12653142830070628418u64,
                1304865081198472589u64,
                15487088723018451349u64,
                7356056265437611355u64,
                12754u64,
            ]),
            BigInteger([
                16951764897744833770u64,
                9050707197889986034u64,
                18294565017731275064u64,
                17289009964771944478u64,
                15474953600943030543u64,
                10543112660465049513u64,
                173734179671323886u64,
                16226848431985143551u64,
                3611786703940475841u64,
                12726149106651758173u64,
                3382139053833772449u64,
                1241575198264029658u64,
                13493u64,
            ]),
            BigInteger([
                7731541579845632721u64,
                6440984486218825327u64,
                14893818834201281911u64,
                9410398678785435987u64,
                11498359652465294341u64,
                6345848620415467849u64,
                1756300238603756343u64,
                10352546688154188388u64,
                3495266469125463198u64,
                12676653995465403039u64,
                7448002977599557278u64,
                9374860005835379764u64,
                11515u64,
            ]),
        ],
    ];
    const POSEIDON_PARTIAL_ROUNDS: u32 = 31;
}
