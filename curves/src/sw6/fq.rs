// Copyright (C) 2019-2021 Aleo Systems Inc.
// This file is part of the snarkVM library.

// The snarkVM library is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// The snarkVM library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with the snarkVM library. If not, see <https://www.gnu.org/licenses/>.

use snarkvm_fields::{FftParameters, FieldParameters, Fp832, Fp832Parameters, PoseidonMDSParameters};
use snarkvm_utilities::biginteger::BigInteger832 as BigInteger;

pub type Fq = Fp832<FqParameters>;

pub struct FqParameters;

impl Fp832Parameters for FqParameters {}

impl FftParameters for FqParameters {
    type BigInteger = BigInteger;

    const TWO_ADICITY: u32 = 3;
    #[rustfmt::skip]
    const TWO_ADIC_ROOT_OF_UNITY: BigInteger = BigInteger([
        18044746167194862600u64,
        63590321303744709u64,
        5009346151370959890u64,
        2859114157767503991u64,
        8301813204852325413u64,
        5629414263664332594u64,
        2637340888701394641u64,
        17433538052687852753u64,
        2230763098934759248u64,
        3785382115983092023u64,
        8895511354022222370u64,
        15792083141709071785u64,
        1328u64,
    ]);
}

impl FieldParameters for FqParameters {
    const CAPACITY: u32 = Self::MODULUS_BITS - 1;
    /// GENERATOR = 13
    const GENERATOR: BigInteger = BigInteger([
        16669393626057438558u64,
        1640520694378723217u64,
        1598646156981121135u64,
        12401834967100173388u64,
        2356467520877704673u64,
        14759118825104212161u64,
        5556628239575210651u64,
        5317520392768798654u64,
        16398429955031064995u64,
        3556102264904210145u64,
        8166834915717907988u64,
        11926665585800594452u64,
        11716u64,
    ]);
    const INV: u64 = 14469047335842394791u64;
    /// MODULUS = 22369874298875696930346742206501054934775599465297184582183496627646774052458024540232479018147881220178054575403841904557897715222633333372134756426301062487682326574958588001132586331462553235407484089304633076250782629492557320825577
    const MODULUS: BigInteger = BigInteger([
        0xdace79b57b942ae9,
        0x545d85c16dfd424a,
        0xee135c065f4d26b7,
        0x9c2f764a12c4024b,
        0x1ad533049cfe6a39,
        0x52a3fb77c79c1320,
        0xab3596c8617c5792,
        0x830c728d80f9d78b,
        0x6a7223ee72023d07,
        0xbc5d176b746af026,
        0xe959283d8f526663,
        0xc4d2263babf8941f,
        0x3848,
    ]);
    const MODULUS_BITS: u32 = 782;
    const MODULUS_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0x6d673cdabdca1574,
        0xaa2ec2e0b6fea125,
        0xf709ae032fa6935b,
        0xce17bb2509620125,
        0xd6a99824e7f351c,
        0x2951fdbbe3ce0990,
        0xd59acb6430be2bc9,
        0xc1863946c07cebc5,
        0x353911f739011e83,
        0xde2e8bb5ba357813,
        0xf4ac941ec7a93331,
        0x6269131dd5fc4a0f,
        0x1c24,
    ]);
    const R: BigInteger = BigInteger([
        11190988450819017841u64,
        16170411717126802030u64,
        2265463223430229059u64,
        16946880912571045974u64,
        11155248462028513229u64,
        12855672356664541314u64,
        8489376931127408159u64,
        2655797810825538098u64,
        9648483887143916718u64,
        17514963461276738952u64,
        16777089214204267338u64,
        15649035958020076168u64,
        8659u64,
    ]);
    const R2: BigInteger = BigInteger([
        13983406830510863714u64,
        17863856572171232656u64,
        1698388424046564526u64,
        1773634430448388392u64,
        8684647957094413275u64,
        3992637317298078843u64,
        18420879196616862245u64,
        3238482510270583127u64,
        7928200707794018216u64,
        10024831010452223910u64,
        9613847725664942650u64,
        15361265984156787358u64,
        7833u64,
    ]);
    const REPR_SHAVE_BITS: u32 = 50;
    // T =
    // 2796234287359462116293342775812631866846949933162148072772937078455846756557253067529059877268485152522256821925480238069737214402829166671516844553287632810960290821869823500141573291432819154425935511163079134531347828686569665103197
    const T: BigInteger = BigInteger([
        0x5b59cf36af72855d,
        0xea8bb0b82dbfa849,
        0x7dc26b80cbe9a4d6,
        0x3385eec942588049,
        0x35aa660939fcd47,
        0x4a547f6ef8f38264,
        0x7566b2d90c2f8af2,
        0xf0618e51b01f3af1,
        0xcd4e447dce4047a0,
        0x778ba2ed6e8d5e04,
        0xfd2b2507b1ea4ccc,
        0x189a44c7757f1283,
        0x709,
    ]);
    // (T - 1)/2 =
    // 1398117143679731058146671387906315933423474966581074036386468539227923378278626533764529938634242576261128410962740119034868607201414583335758422276643816405480145410934911750070786645716409577212967755581539567265673914343284832551598
    const T_MINUS_ONE_DIV_TWO: BigInteger = BigInteger([
        0xadace79b57b942ae,
        0x7545d85c16dfd424,
        0xbee135c065f4d26b,
        0x99c2f764a12c4024,
        0x1ad533049cfe6a3,
        0x252a3fb77c79c132,
        0xbab3596c8617c579,
        0x7830c728d80f9d78,
        0x66a7223ee72023d0,
        0x3bc5d176b746af02,
        0xfe959283d8f52666,
        0x8c4d2263babf8941,
        0x384,
    ]);
}

impl PoseidonMDSParameters for FqParameters {
    const POSEIDON_ALPHA: u64 = 31;
    const POSEIDON_FULL_ROUNDS: u32 = 8;
    const POSEIDON_MDS: [[Self::BigInteger; 3]; 3] = [
        [
            BigInteger([
                13692774114766212676u64,
                52923901070279916u64,
                12606167234025517808u64,
                4262686078772928100u64,
                7348192565293066290u64,
                16698963089651741002u64,
                10676552558400300023u64,
                17952942321562008539u64,
                11413497647737293177u64,
                12847164886812388528u64,
                2461723128312556257u64,
                17390180011863947699u64,
                7056u64,
            ]),
            BigInteger([
                16058703512244606161u64,
                6582704113702332092u64,
                13646728278108766984u64,
                13866039719159434233u64,
                9985900993810008512u64,
                13864332586156858187u64,
                7257476224274555696u64,
                17772270711132876078u64,
                7118989833489656879u64,
                14310873359325085182u64,
                4620690686966015536u64,
                3619076268634971416u64,
                13007u64,
            ]),
            BigInteger([
                11914313903351795785u64,
                14157932646252860019u64,
                7343410265941103486u64,
                3656555446530603734u64,
                1961933237379063507u64,
                779708889551894537u64,
                2397311836714561494u64,
                16244928205924179610u64,
                2202102474291863027u64,
                6739229165636708306u64,
                8176866060164161647u64,
                3847897686600013101u64,
                13898u64,
            ]),
        ],
        [
            BigInteger([
                11558592044551982123u64,
                6408060928432973626u64,
                7134019372136194900u64,
                8383946123390990408u64,
                7279059631715761988u64,
                13610521835506869182u64,
                3044220696523750255u64,
                1753637328976598742u64,
                10879240354761768959u64,
                16499287084884981459u64,
                2203272374430074142u64,
                9991193907943267725u64,
                3459u64,
            ]),
            BigInteger([
                10560550647792157894u64,
                16232836838371299880u64,
                7920760768313535851u64,
                2877448542416580778u64,
                10413490261530939385u64,
                8984139769612745174u64,
                875746555401155206u64,
                5552167156676240794u64,
                5557026610405379962u64,
                3940946522172823712u64,
                15439903532459993314u64,
                10270301218107282346u64,
                5546u64,
            ]),
            BigInteger([
                3339164951214259591u64,
                350726412724208896u64,
                6909419480047786581u64,
                11336644568504590455u64,
                10503097869638826530u64,
                17659255587793653411u64,
                13599433404098352987u64,
                9194369101217098453u64,
                7717103804220132669u64,
                10687136241926733930u64,
                89255736872672403u64,
                15360195551426871788u64,
                5481u64,
            ]),
        ],
        [
            BigInteger([
                2237806560767426412u64,
                4983449287966654836u64,
                1742040235891238286u64,
                13687199753792363577u64,
                7750418863877352185u64,
                2239873359439744664u64,
                5831072781747015272u64,
                18298087479832009885u64,
                7529968759260048123u64,
                11400426183950968754u64,
                16584767087856727719u64,
                665371245699121617u64,
                11614u64,
            ]),
            BigInteger([
                6509164272076747018u64,
                9745574121291751665u64,
                7808115337851674565u64,
                5395932558024046808u64,
                9110852763293636776u64,
                14144964622802255547u64,
                10686771852445692031u64,
                1018361240457798047u64,
                12945784524524503238u64,
                17928756464815476071u64,
                5474422894789060556u64,
                12394452176890845330u64,
                9299u64,
            ]),
            BigInteger([
                18310758673335070908u64,
                5597199617183812266u64,
                1970646598372957101u64,
                2915942081984928322u64,
                13359808509734057017u64,
                16394370043040867403u64,
                6676788717228964680u64,
                17456911843821317263u64,
                5988298440284039912u64,
                3050172625844837192u64,
                10478532570585805743u64,
                10463688122194519278u64,
                13979u64,
            ]),
        ],
    ];
    const POSEIDON_PARTIAL_ROUNDS: u32 = 24;
}
